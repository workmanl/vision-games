<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vision Quest: Memory Master</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #2e0a0a 0%, #150505 100%);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      overflow-y: auto;
      padding: 20px 0;
    }

    .container {
      text-align: center;
      padding: 20px;
      max-width: 1000px;
      width: 100%;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      background: linear-gradient(45deg, #ff1744, #ff6b6b, #ff4081);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 30px rgba(255, 23, 68, 0.5);
      animation: titleGlow 2s ease-in-out infinite alternate;
    }

    @keyframes titleGlow {
      from { filter: brightness(1); }
      to { filter: brightness(1.3); }
    }

    .subtitle {
      font-size: 1.2em;
      margin-bottom: 20px;
      color: #ff6b6b;
    }

    .difficulty-selector {
      margin: 20px 0;
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .difficulty-btn {
      padding: 10px 25px;
      font-size: 1em;
      border-radius: 25px;
      border: 2px solid #ff1744;
      background: rgba(255, 23, 68, 0.2);
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .difficulty-btn.active {
      background: linear-gradient(45deg, #ff1744, #ff6b6b);
      border-color: #ff4081;
      transform: scale(1.1);
    }

    .difficulty-btn:hover {
      background: rgba(255, 23, 68, 0.4);
    }

    #stats {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .stat {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px 20px;
      border-radius: 15px;
      border: 2px solid rgba(255, 23, 68, 0.3);
      backdrop-filter: blur(10px);
    }

    .stat-label {
      font-size: 0.9em;
      color: #aaa;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 1.5em;
      font-weight: bold;
      background: linear-gradient(45deg, #ff1744, #ff6b6b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    #game {
      display: grid;
      gap: 12px;
      width: 90vw;
      max-width: 700px;
      margin: 20px auto;
      perspective: 1000px;
    }

    #game.grid-4 {
      grid-template-columns: repeat(4, 1fr);
    }

    #game.grid-6 {
      grid-template-columns: repeat(6, 1fr);
    }

    .card {
      position: relative;
      width: 100%;
      padding-top: 100%;
      cursor: pointer;
      transform-style: preserve-3d;
      transition: transform 0.5s ease;
    }

    .card.flip {
      transform: rotateY(180deg);
    }

    .card.matched {
      animation: matchPulse 0.5s ease;
    }

    @keyframes matchPulse {
      0%, 100% { transform: rotateY(180deg) scale(1); }
      50% { transform: rotateY(180deg) scale(1.1); }
    }

    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      left: 0;
      top: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      backface-visibility: hidden;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .front {
      background: radial-gradient(circle, #1e0a0a 0%, #0a0303 100%);
      border: 3px solid #ff1744;
      font-size: 3em;
      color: #ff1744;
      text-shadow: 0 0 20px rgba(255, 23, 68, 0.8);
      animation: cardGlow 2s ease-in-out infinite alternate;
    }

    @keyframes cardGlow {
      from { box-shadow: 0 5px 15px rgba(255, 23, 68, 0.3), inset 0 0 20px rgba(255, 23, 68, 0.1); }
      to { box-shadow: 0 5px 25px rgba(255, 23, 68, 0.6), inset 0 0 30px rgba(255, 23, 68, 0.2); }
    }

    .back {
      background: linear-gradient(135deg, #ff1744 0%, #ff6b6b 100%);
      border: 3px solid #ff4081;
      transform: rotateY(180deg);
      font-size: 3.5em;
      box-shadow: 0 5px 25px rgba(255, 23, 68, 0.6), inset 0 0 30px rgba(255, 255, 255, 0.2);
    }

    .controls {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
      margin: 20px 0;
    }

    button {
      padding: 15px 40px;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      border: none;
      border-radius: 50px;
      background: linear-gradient(45deg, #ff1744, #ff6b6b);
      color: white;
      box-shadow: 0 5px 20px rgba(255, 23, 68, 0.4);
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 30px rgba(255, 23, 68, 0.6);
    }

    button:active {
      transform: translateY(-1px);
    }

    .clear-btn {
      background: linear-gradient(45deg, #b71c1c, #c62828);
      box-shadow: 0 5px 20px rgba(183, 28, 28, 0.4);
      font-size: 0.9em;
      padding: 10px 25px;
    }

    .clear-btn:hover {
      box-shadow: 0 8px 30px rgba(183, 28, 28, 0.6);
    }

    #message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(30, 10, 10, 0.98);
      padding: 40px 60px;
      border-radius: 25px;
      border: 3px solid #ff1744;
      font-size: 1.8em;
      font-weight: bold;
      color: #ff6b6b;
      box-shadow: 0 0 60px rgba(255, 23, 68, 0.8);
      opacity: 0;
      transition: opacity 0.5s ease;
      z-index: 1000;
      max-width: 90%;
      text-align: center;
      pointer-events: none;
      white-space: pre-line;
    }

    #message.show {
      opacity: 1;
      animation: messageAppear 0.5s ease;
    }

    @keyframes messageAppear {
      0% { transform: translate(-50%, -50%) scale(0); }
      50% { transform: translate(-50%, -50%) scale(1.1); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }

    .best-scores {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin: 15px 0;
      flex-wrap: wrap;
    }

    .best-score {
      background: rgba(255, 215, 0, 0.1);
      border: 2px solid #ffd700;
      padding: 10px 20px;
      border-radius: 15px;
      color: #ffd700;
      font-weight: bold;
    }

    .particle {
      position: fixed;
      pointer-events: none;
      font-size: 2em;
      z-index: 999;
      animation: particleFloat 1.5s ease-out forwards;
    }

    @keyframes particleFloat {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(-150px) rotate(360deg);
        opacity: 0;
      }
    }

    @media (max-width: 950px) {
      h1 {
        font-size: 2em;
      }
      .stat-value {
        font-size: 1.3em;
      }
      button {
        font-size: 1em;
        padding: 12px 30px;
      }
      .back, .front {
        font-size: 2em !important;
      }
    }

    @media (max-height: 800px) {
      h1 {
        font-size: 2em;
        margin-bottom: 5px;
      }
      .subtitle {
        font-size: 1em;
        margin-bottom: 10px;
      }
      #game {
        gap: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß† Vision Quest: Memory Master üíé</h1>
    <p class="subtitle">Match the pairs and boost your visual memory!</p>

    <div class="difficulty-selector">
      <button class="difficulty-btn" data-difficulty="easy">Easy (4√ó4)</button>
      <button class="difficulty-btn active" data-difficulty="medium">Medium (4√ó4)</button>
      <button class="difficulty-btn" data-difficulty="hard">Hard (6√ó6)</button>
    </div>

    <div class="best-scores">
      <div class="best-score">
        üèÜ Best Moves: <span id="bestMoves">--</span>
      </div>
      <div class="best-score">
        ‚ö° Best Time: <span id="bestTime">--</span>
      </div>
    </div>

    <div id="stats">
      <div class="stat">
        <div class="stat-label">Moves</div>
        <div class="stat-value" id="moves">0</div>
      </div>
      <div class="stat">
        <div class="stat-label">Time</div>
        <div class="stat-value" id="time">0:00</div>
      </div>
      <div class="stat">
        <div class="stat-label">Pairs</div>
        <div class="stat-value"><span id="matched">0</span>/<span id="totalPairs">8</span></div>
      </div>
    </div>

    <div id="game" class="grid-4"></div>

    <div class="controls">
      <button id="restart">üîÑ Restart</button>
      <button id="clearScores" class="clear-btn">Clear Scores</button>
    </div>
  </div>

  <div id="message"></div>

  <script>
    /* ---------- CONFIG ---------- */
    const DIFFICULTIES = {
      easy: {
        grid: 4,
        pairs: 8,
        emojis: ['üåü', '‚≠ê', 'üí´', '‚ú®', 'üåô', '‚òÄÔ∏è', 'üåà', 'üé®'],
        flipDelay: 1000,
        fontSize: 3.5
      },
      medium: {
        grid: 4,
        pairs: 8,
        emojis: ['üéÆ', 'üéØ', 'üé™', 'üé≠', 'üé®', 'üé¨', 'üé∏', 'üé∫'],
        flipDelay: 800,
        fontSize: 3.5
      },
      hard: {
        grid: 6,
        pairs: 18,
        emojis: ['üöÄ', 'üõ∏', 'üåç', 'ü™ê', '‚≠ê', 'üåô', '‚òÑÔ∏è', 'üí´', '‚ú®', 'üåü', 'üîÆ', 'üíé', 'üèÜ', 'üëë', 'üéØ', 'üé™', 'üé≠', 'üé®'],
        flipDelay: 600,
        fontSize: 2.5
      }
    };

    let currentDifficulty = 'medium';
    let config = DIFFICULTIES[currentDifficulty];
    let values = [];
    let cards = [];
    let flipped = [];
    let moves = 0;
    let matched = 0;
    let startTime = null;
    let timerInterval = null;
    let gameActive = false;

    const gameDiv = document.getElementById('game');
    const movesSpan = document.getElementById('moves');
    const timeSpan = document.getElementById('time');
    const matchedSpan = document.getElementById('matched');
    const totalPairsSpan = document.getElementById('totalPairs');
    const messageDiv = document.getElementById('message');
    const restartBtn = document.getElementById('restart');
    const clearScoresBtn = document.getElementById('clearScores');
    const bestMovesSpan = document.getElementById('bestMoves');
    const bestTimeSpan = document.getElementById('bestTime');

    // Difficulty selection
    document.querySelectorAll('.difficulty-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentDifficulty = btn.dataset.difficulty;
        config = DIFFICULTIES[currentDifficulty];
        initGame();
      });
    });

    // Load best scores from localStorage
    function loadBestScores() {
      const key = `memoryGame_${currentDifficulty}`;
      const bestMoves = localStorage.getItem(`${key}_moves`);
      const bestTime = localStorage.getItem(`${key}_time`);

      bestMovesSpan.textContent = bestMoves || '--';
      bestTimeSpan.textContent = bestTime ? formatTime(parseInt(bestTime)) : '--';
    }

    // Save best score if it's better
    function saveBestScore() {
      const currentTime = Math.floor((Date.now() - startTime) / 1000);
      const key = `memoryGame_${currentDifficulty}`;
      const bestMoves = localStorage.getItem(`${key}_moves`);
      const bestTime = localStorage.getItem(`${key}_time`);

      let newRecord = false;

      if (!bestMoves || moves < parseInt(bestMoves)) {
        localStorage.setItem(`${key}_moves`, moves);
        newRecord = true;
      }

      if (!bestTime || currentTime < parseInt(bestTime)) {
        localStorage.setItem(`${key}_time`, currentTime);
        newRecord = true;
      }

      loadBestScores();
      return newRecord;
    }

    // Clear all saved scores
    function clearScores() {
      if (confirm('Are you sure you want to clear all saved scores?')) {
        Object.keys(DIFFICULTIES).forEach(diff => {
          const key = `memoryGame_${diff}`;
          localStorage.removeItem(`${key}_moves`);
          localStorage.removeItem(`${key}_time`);
        });
        loadBestScores();
        showMessage('Scores cleared! üóëÔ∏è');
      }
    }

    // Format seconds into M:SS
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    // Update timer display
    function updateTimer() {
      if (!startTime || !gameActive) return;
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      timeSpan.textContent = formatTime(elapsed);
    }

    // Start timer on first click
    function startTimer() {
      if (!startTime) {
        startTime = Date.now();
        gameActive = true;
        timerInterval = setInterval(updateTimer, 1000);
      }
    }

    // Stop timer
    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      gameActive = false;
    }

    // Sound effects
    function playSound(type) {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();

      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);

      if (type === 'flip') {
        oscillator.frequency.value = 600;
        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.1);
      } else if (type === 'match') {
        oscillator.frequency.value = 800;
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.2);
      } else if (type === 'wrong') {
        oscillator.frequency.value = 200;
        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.2);
      } else if (type === 'win') {
        oscillator.frequency.value = 523.25;
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.5);
      }
    }

    // Create particles
    function createParticles(x, y) {
      const emojis = ['‚≠ê', '‚ú®', 'üí´', 'üåü'];
      for (let i = 0; i < 5; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
        particle.style.left = x + (Math.random() - 0.5) * 100 + 'px';
        particle.style.top = y + 'px';
        document.body.appendChild(particle);
        setTimeout(() => particle.remove(), 1500);
      }
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function createCard(val) {
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.value = val;

      const front = document.createElement('div');
      front.className = 'face front';
      front.textContent = '?';

      const back = document.createElement('div');
      back.className = 'face back';
      back.textContent = val;
      back.style.fontSize = config.fontSize + 'em';

      card.append(front, back);
      card.addEventListener('click', handleClick);
      return card;
    }

    function initGame() {
      // Setup values
      values = [...config.emojis.slice(0, config.pairs), ...config.emojis.slice(0, config.pairs)];
      shuffle(values);

      cards = [];
      flipped = [];
      moves = 0;
      matched = 0;
      startTime = null;
      stopTimer();

      movesSpan.textContent = moves;
      matchedSpan.textContent = matched;
      totalPairsSpan.textContent = config.pairs;
      timeSpan.textContent = '0:00';

      // Setup grid
      gameDiv.innerHTML = '';
      gameDiv.className = `grid-${config.grid}`;

      for (let v of values) {
        const c = createCard(v);
        gameDiv.appendChild(c);
        cards.push(c);
      }

      loadBestScores();
    }

    function handleClick(e) {
      const card = e.currentTarget;
      if (card.classList.contains('flip') || flipped.length === 2) return;

      startTimer();
      playSound('flip');

      card.classList.add('flip');
      flipped.push(card);

      if (flipped.length === 2) {
        moves++;
        movesSpan.textContent = moves;
        setTimeout(checkMatch, config.flipDelay);
      }
    }

    function checkMatch() {
      const [a, b] = flipped;

      if (a.dataset.value === b.dataset.value) {
        // Match!
        matched++;
        matchedSpan.textContent = matched;

        a.classList.add('matched');
        b.classList.add('matched');

        playSound('match');

        // Create particles at card locations
        const rectA = a.getBoundingClientRect();
        const rectB = b.getBoundingClientRect();
        createParticles(rectA.left + rectA.width / 2, rectA.top + rectA.height / 2);
        createParticles(rectB.left + rectB.width / 2, rectB.top + rectB.height / 2);

        if (matched === config.pairs) {
          stopTimer();
          playSound('win');
          const isNewRecord = saveBestScore();
          const finalTime = formatTime(Math.floor((Date.now() - startTime) / 1000));

          let message = `üéâ Amazing! You Won! üéâ\n\n`;
          message += `Moves: ${moves}\n`;
          message += `Time: ${finalTime}\n`;
          if (isNewRecord) message += `\n‚ú® NEW RECORD! ‚ú®`;

          setTimeout(() => showMessage(message), 500);
        }
      } else {
        // No match
        playSound('wrong');
        a.classList.remove('flip');
        b.classList.remove('flip');
      }

      flipped = [];
    }

    function showMessage(txt) {
      messageDiv.textContent = txt;
      messageDiv.classList.add('show');
      setTimeout(() => {
        messageDiv.classList.remove('show');
      }, 4000);
    }

    /* ---- EVENT LISTENERS ---- */
    restartBtn.addEventListener('click', initGame);
    clearScoresBtn.addEventListener('click', clearScores);

    /* ---- START ---- */
    loadBestScores();
    initGame();
  </script>
</body>
</html>
